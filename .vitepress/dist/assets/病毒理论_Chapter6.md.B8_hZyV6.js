import{_ as t,c as a,o as l,a1 as i}from"./chunks/framework.BwTyoF0R.js";const e="/assets/Untitled%203.BanUo4vq.png",s="/assets/Untitled%204.D3zaDTK0.png",r="/assets/Untitled%205.CxdOV91R.png",n="/assets/Untitled%206.CbDgs9hV.png",o="/assets/Untitled%207.CoucxzeJ.png",h="/assets/Untitled%208.BElBlZrt.png",p="/assets/Untitled%209.DjbuHGwF.png",d="/assets/Untitled%2010.DZlOuQNZ.png",c="/assets/Untitled%2011.G0QAFSz9.png",u="/assets/Untitled%2012.anMMUbM7.png",m="/assets/Untitled%2013.D4c2ji_F.png",_="/assets/Untitled%2014.pmXkeXK2.png",g="/assets/Untitled%2015.kqS8eYL1.png",b="/assets/Untitled%2016.j6SStyFP.png",q="/assets/Untitled%2017.DEYt-oIj.png",U="/assets/Untitled%2018.srzoM5vm.png",P="/assets/Untitled%2019.twQPfhnL.png",f="/assets/Untitled%2020.BMeOGni9.png",j=JSON.parse('{"title":"第六章 病毒的检测","description":"","frontmatter":{},"headers":[],"relativePath":"病毒理论/Chapter6.md","filePath":"病毒理论/Chapter6.md"}'),x={name:"病毒理论/Chapter6.md"},k=i('<h1 id="第六章-病毒的检测" tabindex="-1">第六章 病毒的检测 <a class="header-anchor" href="#第六章-病毒的检测" aria-label="Permalink to &quot;第六章 病毒的检测&quot;">​</a></h1><h2 id="防范措施" tabindex="-1">防范措施 <a class="header-anchor" href="#防范措施" aria-label="Permalink to &quot;防范措施&quot;">​</a></h2><ul><li>消毒软件 <ul><li>找到病毒，清理。</li><li>早期和病毒一一对应，对新病毒无能为力。</li><li>自己可能也会染上病毒</li></ul></li><li>防毒卡 <ul><li>能对抗新病毒，不怕病毒感染。</li><li>不能消除磁盘病毒，使用光谱特征码技术</li></ul></li><li>三合一：查毒杀毒防毒</li></ul><h3 id="防范技术划分" tabindex="-1">防范技术划分 <a class="header-anchor" href="#防范技术划分" aria-label="Permalink to &quot;防范技术划分&quot;">​</a></h3><p>预防、消除、检测、免疫</p><h3 id="主动内核技术与实时监控" tabindex="-1">主动内核技术与实时监控 <a class="header-anchor" href="#主动内核技术与实时监控" aria-label="Permalink to &quot;主动内核技术与实时监控&quot;">​</a></h3><p><img src="'+e+'" alt="Untitled">)</p><h3 id="自动解压缩技术" tabindex="-1">自动解压缩技术 <a class="header-anchor" href="#自动解压缩技术" aria-label="Permalink to &quot;自动解压缩技术&quot;">​</a></h3><p><img src="'+s+'" alt="Untitled">)</p><h3 id="病毒防范的概念" tabindex="-1">病毒防范的概念 <a class="header-anchor" href="#病毒防范的概念" aria-label="Permalink to &quot;病毒防范的概念&quot;">​</a></h3><ul><li>指通过建立合理的计算机病毒防范体系和制度，及时发现计算机病毒侵入，并采取有效的手段阻止计算机病毒的传播和破坏，恢复受影响的计算机系统和数据</li></ul><h2 id="防范策略" tabindex="-1">防范策略 <a class="header-anchor" href="#防范策略" aria-label="Permalink to &quot;防范策略&quot;">​</a></h2><ul><li>预防措施：勤备份，严防守</li><li>检测方法：手工测试、自动测试</li></ul><h2 id="诊断方法及其原理" tabindex="-1">诊断方法及其原理 <a class="header-anchor" href="#诊断方法及其原理" aria-label="Permalink to &quot;诊断方法及其原理&quot;">​</a></h2><h3 id="比较法" tabindex="-1">比较法 <a class="header-anchor" href="#比较法" aria-label="Permalink to &quot;比较法&quot;">​</a></h3><ul><li>用原始的正常备份与被检测的内容(引导扇区或被检测的文件)进行比较</li><li>长度、内容、内存、中断</li></ul><h3 id="校验和法" tabindex="-1">校验和法 <a class="header-anchor" href="#校验和法" aria-label="Permalink to &quot;校验和法&quot;">​</a></h3><ul><li>能发现已知病毒和未知病毒</li><li>对隐蔽性病毒无效</li></ul><h3 id="扫描法" tabindex="-1">扫描法 <a class="header-anchor" href="#扫描法" aria-label="Permalink to &quot;扫描法&quot;">​</a></h3><ul><li>特征代码扫描法</li><li>特征字扫描法</li><li>误报率低、可识别类型和名称</li><li>特征码生成难度大，不能检测未知病毒，不易检测多态病毒</li></ul><h3 id="行为监测法" tabindex="-1">行为监测法 <a class="header-anchor" href="#行为监测法" aria-label="Permalink to &quot;行为监测法&quot;">​</a></h3><ul><li>程序运行时，监视其行为，发现病毒行为立刻报警 <ul><li>int 13H</li><li>对可执行文件做写入动作…</li></ul></li><li>容易误报，某些行为在正常程序也会进行</li></ul><h3 id="感染实验法" tabindex="-1">感染实验法 <a class="header-anchor" href="#感染实验法" aria-label="Permalink to &quot;感染实验法&quot;">​</a></h3><ul><li><p>检测未知引导型病毒的感染实验法</p><p>首先有未被感染的引导区，然后运行可疑文件，重复多次后，将实验盘里的引导区与干净的引导区比较，如果不同，则认为引导区被感染。</p></li><li><p>检测未知文件型病毒的感染实验法</p><p>首先有一批干净的文件，然后运行可疑文件，重复多次后，将实验盘里的文件与干净的文件比较，如果不同，则认为文件被感染。</p></li><li><p>方法与比较法很相似</p><p>不同在于做比较法时，分析人员手上有了被感染的文件/引导区/内存和干净的文件/引导区/内存。而做实验感染法时，分析人员手上是可疑病毒样本和干净的文件/引导区。</p></li></ul><h3 id="软件模拟法" tabindex="-1">软件模拟法 <a class="header-anchor" href="#软件模拟法" aria-label="Permalink to &quot;软件模拟法&quot;">​</a></h3><ul><li>用软件方法来模拟和分析程序的运行：模拟CPU执行，在其设计的虚拟机器(Virtual Machine)下假执行病毒的变体引擎解码程序，安全并确实地将多态病毒解开，使其显露真实面目，再加以扫描</li><li>常用于检测多态病毒</li></ul><h3 id="分析法" tabindex="-1">分析法 <a class="header-anchor" href="#分析法" aria-label="Permalink to &quot;分析法&quot;">​</a></h3><ul><li>静态分析、动态分析</li></ul><h3 id="启发式代码扫描法" tabindex="-1">启发式代码扫描法 <a class="header-anchor" href="#启发式代码扫描法" aria-label="Permalink to &quot;启发式代码扫描法&quot;">​</a></h3><ul><li>from人工智能</li><li>虚报谎报 <ul><li>无罪假定</li><li>提高对正常、特定程序的识别</li><li>多种可疑功能操作同时并发的情况视为报警标准</li><li>设定阈值</li></ul></li></ul><h3 id="传统-启发" tabindex="-1">传统+启发 <a class="header-anchor" href="#传统-启发" aria-label="Permalink to &quot;传统+启发&quot;">​</a></h3><h2 id="虚拟机查毒" tabindex="-1">虚拟机查毒 <a class="header-anchor" href="#虚拟机查毒" aria-label="Permalink to &quot;虚拟机查毒&quot;">​</a></h2><p><img src="'+r+'" alt="Untitled">)</p><p>查毒虚拟机和传统虚拟机的区别，查毒虚拟机只是模拟CPU，而传统虚拟机模拟了CPU、内存、外设等，给用户的感觉像是在真实机器上运行一样。</p><ul><li>单步和断点跟踪法</li><li>虚拟执行法</li></ul><p><img src="'+n+'" alt="Untitled">)</p><p><img src="'+o+'" alt="Untitled"></p><p><img src="'+h+'" alt="Untitled">)</p><h2 id="反虚拟机技术" tabindex="-1">反虚拟机技术 <a class="header-anchor" href="#反虚拟机技术" aria-label="Permalink to &quot;反虚拟机技术&quot;">​</a></h2><p><strong>插入特殊指令技术</strong>，虚拟机毕竟不是真正CPU，不会支持整个Intel指令集。虚拟机在遇到不能模拟的指令时将会立即停止工作。通过人为的插入特殊指令，对病毒解密本身没有任何影响，但可以干扰虚拟机的工作。对抗这种方法可以采用计算指令长度，直接跳过特殊指令。</p><p>更好的方法是将特殊指令交给真实CPU直接执行。</p><p><strong>结构化异常处理技术</strong>，虚拟机在遇到非法指令时，通常会停止运行。病毒通过往病毒体内插入非法指令，并设置自己的异常处理函数，并将真正的解密代码放到异常处理函数中。这样，当虚拟机执行到非法指令时，不但虚拟机会停止，控制流也会转向到病毒自己设置的异常处理函数中。设计良好的虚拟机应该能够具备发现病毒安装的异常处理函数的功能。</p><p><strong>入口点模糊技术</strong>，虚拟机出于效率方面的考虑，通常只会模拟执行入口点后的一段代码，如果病毒采用了EPO，并在这段代码内没有跳转到病毒代码，则可以逃过虚拟机检测。</p><p><strong>多线程技术</strong>，病毒开始时，开启另一个工作线程，并将病毒解密流程放置于工作线程中。由于虚拟机不能模拟多线程切换，所以可以逃避虚拟机检测。和结构化异常处理一样，病毒借用了操作系统机制，但虚拟机并不支持这些操作系统机制。</p><p><strong>元多形技术</strong>，同学们下来自行查阅。</p><h2 id="实时监控" tabindex="-1">实时监控 <a class="header-anchor" href="#实时监控" aria-label="Permalink to &quot;实时监控&quot;">​</a></h2><p>DOS时代通常采用挂接系统中断的方式实现实时监控。而在Windows时代，在ring3下无法对整个系统进行实时监控，所以一般采用驱动程序的方式，获得ring0权限，在系统内核中运行。</p><ul><li>驱动难写、占用资源</li></ul><p><img src="'+p+'" alt="Untitled">)</p><p><img src="'+d+'" alt="Untitled">)</p><h2 id="病毒清除" tabindex="-1">病毒清除 <a class="header-anchor" href="#病毒清除" aria-label="Permalink to &quot;病毒清除&quot;">​</a></h2><p><img src="'+c+'" alt="Untitled">)</p><p><img src="'+u+'" alt="Untitled">)</p><p><img src="'+m+'" alt="Untitled">)</p><p><img src="'+_+'" alt="Untitled">)</p><p><img src="'+g+'" alt="Untitled">)</p><p><img src="'+b+'" alt="Untitled">)</p><p><img src="'+q+'" alt="Untitled">)</p><p><img src="'+U+'" alt="Untitled">)</p><p><img src="'+P+'" alt="Untitled">)</p><p><img src="'+f+'" alt="Untitled">)</p>',61),C=[k];function D(S,T,B,M,O,V){return l(),a("div",null,C)}const v=t(x,[["render",D]]);export{j as __pageData,v as default};
